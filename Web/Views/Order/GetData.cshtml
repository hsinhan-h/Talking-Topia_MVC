@model OrderResultListViewModel

@section topCSS {
    <link rel="stylesheet" href="~/css/ShoppingCartInfo.css" />
}


<div class="container" id="con-cartinfo">
    @if (Model.OrderResult != null && Model.OrderResult.Any())
    {
        <h2>交易紀錄</h2>
        <p>
            若因為教師或學生個人因素導致無法繼續上課，已購買課程將退至原消費之信用卡，請聯繫客服。
        </p>
        <p>若待付款訂單中包含"未付款之體驗課"，需先取消或支付該筆訂單方可成功購買</p>


        @foreach (var item in Model.OrderResult)
        {
            var itemId = item.CourseId;

            <div class="accordion accordion-flush" id="accordionFlushExample">
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                style="border: 1px solid #02cab9"
                                data-bs-target="#@item.CourseId" aria-expanded="false" aria-controls="orderId-1">
                            訂單編號 #@item.TrackingNumber （可點選展開交易明細）
                        </button>
                    </h2>
                    <div id="@item.CourseId" class="accordion-collapse collapse" data-bs-parent="#accordionFlushExample">
                        <div class="accordion-body">
                            <div class="order-info">
                                <h5>訂單資料</h5>
                                <div class="table-responsive">
                                    <table class="table table-hover table-success-order table-transaction">
                                        <thead>
                                            <tr>
                                                <td>交易時間</td>
                                                <td>教師名稱</td>
                                                <td>課程內容</td>
                                                <td>堂數</td>
                                                <td>金額</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>@item.OrderDatetime</td>
                                                <td>@item.FullName</td>
                                                <td>@item.CourseTitle</td>
                                                <td>@item.CourseQuantity</td>
                                                <td>@item.SubtotalNTD.ToString("#,###")</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <div class="reserve-info">
                                <h5>最新預約資訊</h5>
                                <div class="table-responsive">
                                    <table class="table table-hover table-success-order">
                                        <thead>
                                            <tr>
                                                <td>教師名稱</td>
                                                <td>課程內容</td>
                                                <td>預約日期</td>
                                                <td>預約時間</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>@item.FullName</td>
                                                <td>@item.CourseTitle</td>
                                                <td>@item.BookingDate</td>
                                                <td>@item.BookingTime </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        }
    }
    else
    {
        <style>
            .booking-success {
                color: var(--highlight-color);
                font-weight: 900;
            }

            .booking-success-wrapper h2 {
                font-size: 36px;
            }

            .booking-success-wrapper p {
                font-size: 20px;
            }

            .slogan-wrapper {
                background-color: var(--theme-color);
            }

            .slogan {
                color: #fff;
                font-weight: 600;
                font-size: 18px;
                text-align: center;
            }
        </style>

        <partial name="_BannerPartial" />
        <div class="booking-success-wrapper col-12 d-flex flex-column align-items-center m-auto">
            <h2 class="mt-5 mb-3  booking-success">查無交易紀錄<i class="bi bi-calendar-check ms-3"></i></h2>
            <p class="mb-5">系統將在 <strong style="color:blue"><span class="countdown">6</span>秒後 </strong> 自動跳轉回原頁面</p>
            <div class="slogan-wrapper p-4 w-100">
                <p class="slogan">TalkingTopia：連結世界，開啟學習新境界！</p>
                <p class="slogan">"專業導師，量身定制，讓學習變得輕鬆自在！"</p>
            </div>

        </div>
        <script>
            let countdownNumber = 6;
            const countdownEl = document.querySelector('.countdown');

            const countdownInterval = setInterval(function() {
                countdownNumber--;
                countdownEl.textContent = countdownNumber;

                if(countdownNumber === 0) {
                    clearInterval(countdownInterval);
                    // window.location.href = '/Course/CourseList';
                    window.history.back();
                }
            }, 1000);
        </script>
    }
</div>
